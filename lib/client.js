// Generated by CoffeeScript 1.7.1
var Client, Connection, Row, Scanner, Table;

Connection = require("./connection");

Table = require("./table");

Row = require("./row");

Scanner = require("./scanner");


/*

Client: server information and object factory
=============================================

Creating a new client
---------------------

A new instance of "HBase" may be instantiated with an object containing the following properties:   

-   *host*
    string, optional, default to "localhost"
    Domain or IP of the HBase Stargate server
-   *port*
    string or int, optional, default to "8080"
    Port of the HBase REST server

Calling the `hbase` method return an initialized client object.

```javascript
var hbase = require('hbase');
var client = hbase({ options });
```

You can also manually contruct a new instance as follow:

```javascript
var hbase = require('hbase');
var client = new hbase.Client({ options });
```
 */

Client = function(options) {
  if (!options) {
    options = {};
  }
  if (!options.host) {
    options.host = "127.0.0.1";
  }
  if (!options.port) {
    options.port = "8080";
  }
  if (!options.timeout) {
    options.timeout = 60 * 1000;
  }
  this.options = options;
  this.connection = new Connection(this);
  return this;
};


/*
Query Software Version
----------------------

```javascript
client.getVersion( function( error, version ){
  console.log( version );
} );
```

Will print something similar to:

```json
{ Server: 'jetty/6.1.24'
, REST: '0.0.2'
, OS: 'Mac OS X 10.6.4 x86_64'
, Jersey: '1.1.5.1'
, JVM: 'Apple Inc. 1.6.0_20-16.3-b01-279'
}
```
 */

Client.prototype.getVersion = function(callback) {
  return this.connection.get("/version", callback);
};


/*
Query Storage Cluster Version
-----------------------------

```javascript
client.getVersionCluster( function( error, versionCluster ){
  console.log( versionCluster );
} );
```

Will print something similar to:

```csv
'0.89.20100726'
```
 */

Client.prototype.getVersionCluster = function(callback) {
  return this.connection.get("/version/cluster", callback);
};


/*
Query Storage Cluster Status
----------------------------

```javascript
client.getStatusCluster( function( error, statusCluster ){
  console.log( statusCluster );
} );
```

Will print something similar to:

```json
{ requests: 0
, regions: 3
, averageLoad: 3
, DeadNodes: [ null ]
, LiveNodes: [ { Node: [Object] } ]
}
```
 */

Client.prototype.getStatusCluster = function(callback) {
  return this.connection.get("/status/cluster", callback);
};


/*
List tables
-----------

```javascript
client.getTables( function( error, tables ){
  console.log( tables );
} );
```

Will print something similar to:

```json
[ { name: 'node_hbase' } ]
```
 */

Client.prototype.getTables = function(callback) {
  return this.connection.get("/", function(err, data) {
    return callback(err, (data && data.table ? data.table : null));
  });
};

Client.prototype.getTable = function(name) {
  return new Table(this, name);
};

Client.prototype.getRow = function(table, row) {
  return new Row(this, table, row);
};

Client.prototype.getScanner = function(table, id) {
  return new Scanner(this, table, id);
};

module.exports = Client;
